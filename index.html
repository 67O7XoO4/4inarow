<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0,minimal-ui">

    <title>4 in a ROW</title>
    
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://unpkg.com/vue-material/dist/vue-material.min.css">
    <link rel="stylesheet" href="https://unpkg.com/vue-material/dist/theme/default.css">

    <style type="text/css">

    [v-cloak] > *  {
      display: none;
    }

    [v-cloak]::before {
      content: "4 In A Row";
      display: block;
      width: 225px;
      height: 250px;
      background-image: url("/images/loading2.png");
      font-size: 3em;
      font-weight: bold;
      line-height: normal;
      text-align: center;
      background-position: center;
      background-repeat: no-repeat;
      margin-left: auto;
      margin-right: auto;
    }

    .md-card.user-card {
      max-width: 250px; 
    }
    .md-app-content .md-card.user-card {
      margin-left: 8px;
      margin-right: 8px; 
    }
    .md-card.user-card.current-player {
      border: solid 1px;
    }

    .board-card  {
      width: min(90vw, 80vh);
      height: min(90vw, 80vh);
      max-height: 550px; 
      max-width: 550px; 
      background-color: rgb(245, 245, 245); 
    }
 
   </style>
   <script type="text/x-template" id="user-board-template">
    
      <md-card class="user-card"
           :class="{'md-elevation-6' : player.isCurrentPlayer, 'current-player' : player.isCurrentPlayer,  }"
           :style="{'border-color' : player.color}">
        <md-card-header>
          <md-card-header-text >
            <div class="md-title md-small-hide">{{player.name}}</div>
            <div v-if="player.isHuman()"  class="md-subhead md-small-hide" >{{$t('playedByHumanTitle')}}</div>
            <div v-if="! player.isHuman()" class="md-subhead md-small-hide">{{$t('playedByComputerTitle')}}</div>
             
          </md-card-header-text>
          <md-avatar class="md-large">
            <md-icon v-if="player.isHuman()" :title="$t('playedByHumanTitle')" :style="{color : player.color}">person</md-icon>
            <md-icon v-if="! player.isHuman()" :title="$t('playedByComputerTitle')" :style="{color : player.color}">computer</md-icon>
          </md-avatar> 
          
        </md-card-header>

        <md-card-actions>
          
          <md-dialog  :md-active.sync="dialogSettings.show">
            <md-dialog-title>{{$t('settings')}}</md-dialog-title>
            <md-dialog-content>
              <md-field>
                <div class="md-subhead" v-if="player.isHuman()">{{$t('playedByHumanTitle')}}</div>
                <div class="md-subhead"  v-if=" ! player.isHuman()">{{$t('playedByComputerTitle')}}</div>
                <md-subheader>{{$t('changePlayerTypeTitle')}}</md-subheader>
                <md-switch id="changePlayerType" :value="player.isHuman()" v-on:change="changeStrategy" :title="$t('changePlayerTypeTitle')"></md-switch>
              </md-field>

              <md-list v-show="! player.isHuman()">
                <md-subheader>{{$t('depth')}}</md-subheader>
                <md-list-item v-for="i in [4,5,6,7,8,9]" >
                  <md-radio v-model="player.strategy.depth" :value="i" :key="i" />
                  <span class="md-list-item-text"> {{ $t('level_' + i) }}</span>
                  <md-badge class="md-primary" :md-content="i" :title="$t('level_' + i)" />
                </md-list-item>
              </md-list>
            </md-dialog-content>
            <md-dialog-actions>
              <md-button class="md-primary" @click="dialogSettings.show = false">Close</md-button>
            </md-dialog-actions>
          </md-dialog>

          <md-chip class="md-primary"  v-if="! player.isHuman()"
                  :title="$t('level_' + player.strategy.depth)">{{ player.strategy.depth }}</md-chip>
           

          <!-- settings -->
          <md-button @click="dialogSettings.show = true"
            :title="$t('playerSettingsTitle')"
            class="md-icon-button">
            <md-icon>settings</md-icon>
          </md-button>

          <!-- resume -->
          <md-button v-on:click="resume"  
            :title="$t('playerSuspendedTitle')"
            class="md-fab md-accent"
            v-if="! player.isHuman() && player.suspended">
            <md-icon>play_circle_outline</md-icon>
          </md-button>

          <!-- pause -->
          <md-button v-on:click="pause"  
            :title="$t('suspendPlayerTitle')"
            class="md-icon-button "
            v-if="! player.isHuman() && ! player.suspended">
            <md-icon>pause_circle_outline</md-icon>
          </md-button>
        </md-card-actions>
      </md-card>
      
    </script>
  </head>


  <body>

    <div id="fourInARowApp" class="page-container md-layout-row" v-cloak>
      <md-app>
        <md-app-toolbar class="md-primary">
          <md-button class="md-icon-button" @click="menu.show = true">
            <md-icon>menu</md-icon>
          </md-button>
          <span class="md-title">{{ $t("title") }}</span>
        </md-app-toolbar>

        <md-app-drawer  md-swipeable :md-active.sync="menu.show">
          <md-toolbar class="md-transparent" md-elevation="0">
            <span class="md-title">{{ $t("title") }}</span>
          </md-toolbar>
          <md-field>
            <label for="lang">{{ $t("chooseLang") }}</label>
            <md-select id="lang" v-model="$i18n.locale">
              <md-option v-for="(lang, i) in langs" :key="`Lang${i}`" :value="lang">{{ lang }}</option>
            </md-select>
        </md-field>
      </md-app-drawer>

      <md-app-content>

        <div class="md-layout">

          <md-card class="md-layout-item md-xsmall-size-100 board-card md-elevation-2"> <canvas id="boardCanvas"></canvas>  </md-card>

          <div class="md-layout md-alignment-top-left">

            <div class=" md-layout-item md-medium-size-100 md-large-size-66 md-xlarge-size-50 ">
              <md-toolbar md-elevation="0" class="md-transparent md-dense">
             
                <!-- UNDO -->
                <md-button  class="md-dense"
                            v-on:click="undo"
                            :title="$t('undoTitle')"
                            :disabled="isUndoDisabled">
                  <md-icon>undo</md-icon> Undo
                </md-button>

                <!-- start a new game -->
                <md-button  class="md-dense"
                            @click="checkRestart"
                            :title="$t('cancelRestartTitle')" >
                  <md-icon>play_circle_outline</md-icon>{{ $t("newGame") }}
                </md-button>

              </md-toolbar>
            </div>
            <div class=" md-layout-item md-medium-hide md-large-size-33 md-xlarge-size-50">
            </div>

            <div class=" md-layout-item md-medium-size-50 md-large-size-33 md-xlarge-size-25">
              <user-board  :player='players[0]'  v-on:resume='resume' ></user-board>
            </div>

            <div class=" md-layout-item md-medium-size-50 md-large-size-33 md-xlarge-size-25">
              <user-board :player='players[1]' v-on:resume='resume' ></user-board>
            </div>
          </div>

        </div>


        <md-snackbar id="snackbarmsg" :md-active.sync="snackbar.show"> 
          <span>{{ snackbar.msg }}</span>
          <md-button class="md-primary" @click="snackbar.show = false"><md-icon>close</md-icon></md-button>
        </md-snackbar >
 
      </md-app-content> 
      </md-app>

      <md-dialog-confirm
          :md-active.sync="showRestartConfirm"
          :md-title="$t('cancelRestartTitle')"
          md-content=""
          :md-confirm-text="$t('confirm')"
          :md-cancel-text="$t('cancel')"
          @md-confirm="onConfirmRestart" />
    </div>
        
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.0"></script>
    <script src="https://unpkg.com/vue-i18n@8.22.0/dist/vue-i18n.js"></script>
    <script src="https://unpkg.com/vue-material"></script>
    
    <script type="module" src="./src/4inarow.js"></script>


  </body>
</html>